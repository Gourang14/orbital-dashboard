<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORBITAL COMMAND | Unified Dashboard</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- External Libs -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script> <!-- FontAwesome -->

    <!-- Custom Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/space_theme.css') }}">
</head>

<body>
    <canvas id="starfield"></canvas>

    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo-area">
                <div class="logo-icon"></div>
                <h2>ORBITAL<br><span>COMMAND</span></h2>
            </div>

            <ul class="nav-links">
                <li class="active" onclick="switchTab('gps')">
                    <span class="icon">üõ∞Ô∏è</span>
                    <span class="text">GPS TRACKING</span>
                </li>
                <li onclick="switchTab('piv')">
                    <span class="icon">üî¨</span>
                    <span class="text">PIV ANALYSIS</span>
                </li>
                <li onclick="switchTab('graphs')">
                    <span class="icon">üìä</span>
                    <span class="text">TELEMETRY GRAPHS</span>
                </li>
                <li onclick="toggleFullscreen()">
                    <span class="icon">‚õ∂</span>
                    <span class="text">FULLSCREEN</span>
                </li>
            </ul>

            <div class="system-status">
                <div class="status-item">
                    <span class="label">SYSTEM</span>
                    <span class="value online">ONLINE</span>
                </div>
                <div class="status-item">
                    <span class="label">DATE</span>
                    <span class="value" id="sys-date">--/--/--</span>
                </div>
                <div class="status-item">
                    <span class="label">TIME</span>
                    <span class="value" id="sys-time">--:--:--</span>
                </div>
            </div>
            <div class="footer-block"></div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- GPS DASHBOARD TAB -->
            <section id="gps-tab" class="dashboard-tab active">
                <header class="tab-header">
                    <h1>GLOBAL POSITIONING SYSTEMS</h1>
                    <div class="header-controls">
                        <button class="btn-neon" onclick="refreshGPSData()">REFRESH LINK</button>
                    </div>
                </header>

                <div class="grid-layout gps-grid">
                    <!-- Map Module -->
                    <div class="card map-card">
                        <div class="card-header">
                            <h3><i class="fas fa-map-marked-alt"></i> LIVE TRACKING MAP</h3>
                            <div class="card-dots"></div>
                        </div>
                        <div class="card-body">
                            <div id="map"></div>
                        </div>
                    </div>

                    <!-- Stats Module -->
                    <div class="card stats-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-bar"></i> TELEMETRY STATS</h3>
                        </div>
                        <div class="card-body">
                            <div class="stat-row">
                                <div class="stat-box">
                                    <span class="stat-label">AVG TEMP</span>
                                    <span class="stat-value neon-blue" id="avg-temp">--¬∞C</span>
                                </div>
                                <div class="stat-box">
                                    <span class="stat-label">ACTIVE BOTS</span>
                                    <span class="stat-value neon-green" id="active-bots">--</span>
                                </div>
                            </div>
                            <div id="mini-chart"></div>
                        </div>
                    </div>

                    <!-- Data Grid Module -->
                    <div class="card grid-card">
                        <div class="card-header">
                            <h3><i class="fas fa-database"></i> DATA STREAM</h3>
                        </div>
                        <div class="card-body terminal-view">
                            <table id="gps-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>ROBOT</th>
                                        <th>TEMP</th>
                                        <th>LAT</th>
                                        <th>LON</th>
                                        <th>TIME</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PIV ANALYSIS TAB -->
            <section id="piv-tab" class="dashboard-tab">
                <header class="tab-header">
                    <h1>PARTICLE IMAGE VELOCIMETRY</h1>
                    <div class="header-controls">
                        <select id="camera-select" class="neon-select">
                            <option value="user">Front Camera</option>
                            <option value="environment">Back Camera</option>
                        </select>
                        <div class="upload-control">
                            <label for="video-upload" class="btn-neon small-btn">
                                <i class="fas fa-upload"></i> Upload Video
                            </label>
                            <input type="file" id="video-upload" accept="video/*" style="display: none;">
                        </div>
                    </div>
                </header>

                <div class="grid-layout piv-grid">
                    <!-- Source Feed -->
                    <div class="card feed-card">
                        <div class="card-header">
                            <h3>SOURCE FEED</h3>
                            <div class="live-indicator">LIVE</div>
                        </div>
                        <div class="card-body video-wrapper">
                            <video id="webcam" autoplay playsinline></video>
                        </div>
                    </div>

                    <!-- Processed Feed -->
                    <div class="card processed-card">
                        <div class="card-header">
                            <h3>PROCESSED OUTPUT</h3>
                            <span id="fps-counter">FPS: 00</span>
                        </div>
                        <div class="card-body canvas-wrapper">
                            <canvas id="processed-canvas"></canvas>
                        </div>
                    </div>

                    <!-- Controls Module -->
                    <div class="card controls-card">
                        <div class="card-header">
                            <h3>FILTER CONFIGURATION</h3>
                        </div>
                        <div class="card-body control-panel">
                            <div class="control-group">
                                <label>ALGORITHM</label>
                                <div class="button-grid">
                                    <button class="filter-btn active" data-filter="original">Original</button>
                                    <button class="filter-btn" data-filter="clahe">CLAHE</button>
                                    <button class="filter-btn" data-filter="histogram-eq">Histogram Eq</button>
                                    <button class="filter-btn" data-filter="edge-detection">Edge Detection</button>

                                    <button class="filter-btn" data-filter="high-pass">High-Pass Filter</button>
                                    <button class="filter-btn" data-filter="gaussian-blur">Gaussian Blur</button>
                                    <button class="filter-btn" data-filter="median-filter">Median Filter</button>
                                    <button class="filter-btn" data-filter="wiener-filter">Wiener Filter</button>

                                    <button class="filter-btn" data-filter="background-subtraction">Background
                                        Sub</button>
                                    <button class="filter-btn" data-filter="contrast-stretch">Contrast Stretch</button>
                                    <button class="filter-btn" data-filter="bilateral-filter">Bilateral Filter</button>
                                    <button class="filter-btn" data-filter="morphological">Morphological Ops</button>
                                </div>
                            </div>

                            <div class="control-group dynamic-controls">
                                <!-- Dynamic sliders injected here -->
                                <div class="slider-container">
                                    <label>INTENSITY</label>
                                    <input type="range" min="0" max="100" value="50" class="neon-slider">
                                </div>
                            </div>

                            <div class="metrics-display">
                                <div class="metric">
                                    <small>MEAN INTENSITY</small>
                                    <div class="metric-bar">
                                        <div class="fill" style="width: 45%"></div>
                                    </div>
                                </div>
                                <div class="metric">
                                    <small>VARIANCE</small>
                                    <div class="metric-bar">
                                        <div class="fill" style="width: 72%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- GRAPHS TAB -->
            <section id="graphs-tab" class="dashboard-tab">
                <header class="tab-header">
                    <h1>TELEMETRY ANALYTICS</h1>
                    <div class="header-controls">
                        <button class="btn-neon" onclick="initGraphs()">REFRESH PLOTS</button>
                    </div>
                </header>

                <div class="grid-layout graphs-grid">
                    <!-- Bar Chart -->
                    <div class="card graph-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> QUALITY METRICS BY ROBOT</h3>
                        </div>
                        <div class="card-body">
                            <div id="quality-chart" style="width:100%; height:100%;"></div>
                        </div>
                    </div>

                    <!-- Pie Chart -->
                    <div class="card graph-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-pie"></i> DATA DISTRIBUTION</h3>
                        </div>
                        <div class="card-body">
                            <div id="distribution-chart" style="width:100%; height:100%;"></div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/starfield.js') }}"></script>
    <script src="{{ url_for('static', filename='js/image_processor.js') }}"></script>
    <script src="{{ url_for('static', filename='js/space_dashboard.js') }}"></script>
</body>

</html>